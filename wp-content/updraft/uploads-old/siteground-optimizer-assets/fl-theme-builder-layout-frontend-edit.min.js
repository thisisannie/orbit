(function(a){FLThemeBuilderLayoutFrontendEdit={_init:function(){this._bind(),this._initContent()},_bind:function(){a('.fl-theme-builder-preview-select').on('click',this._togglePreviewSelect),a('.fl-theme-builder-preview-select-item').on('click',this._togglePreviewSelectItem),a('.fl-theme-builder-preview-select-item').delegate('.fl-theme-builder-preview-select-item-child','click',this._previewSelectItemChildClicked)},_togglePreviewSelect:function(){var b=a('.fl-theme-builder-preview-select');b.toggleClass('fl-theme-builder-preview-select-open')},_togglePreviewSelectItem:function(c){var b=a(c.target).closest('.fl-theme-builder-preview-select-item');children=b.find('.fl-theme-builder-preview-select-item-children'),loc=b.attr('data-location'),loaded=b.attr('data-children-loaded'),loader=a('<img src="'+FLBuilderLayoutConfig.paths.pluginUrl+'img/ajax-loader.svg" />'),title=a('.fl-theme-builder-preview-select-title div span'),void 0!=loc&&(loc=loc.split(':'),'general'==loc[0]?(title.text(b.text()),a('.fl-theme-builder-preview-select').removeClass('fl-theme-builder-preview-select-open'),FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:'update_preview_location',location:b.attr('data-location')},function(){FLBuilder.showAjaxLoader(),window.location.reload(!0)})):'0'==loaded&&(children.append(loader),'post'==loc[0]?FLBuilder.ajax({action:'get_preview_posts',post_type:loc[1]},FLThemeBuilderLayoutFrontendEdit._previewSelectPostsLoaded):'taxonomy'==loc[0]&&FLBuilder.ajax({action:'get_preview_terms',taxonomy:loc[1]},FLThemeBuilderLayoutFrontendEdit._previewSelectTermsLoaded))),a('.fl-theme-builder-preview-select-item-open').removeClass('fl-theme-builder-preview-select-item-open'),b.addClass('fl-theme-builder-preview-select-item-open'),c.stopPropagation()},_previewSelectPostsLoaded:function(f){var b=JSON.parse(f),d=a('[data-location="post:'+b.postType+'"]'),e=d.find('.fl-theme-builder-preview-select-item-children'),c=0;for(d.attr('data-children-loaded','1'),e.find('img').remove();c<b.objects.length;c++)e.append('<div class="fl-theme-builder-preview-select-item-child" data-location="post:'+b.postType+':'+b.objects[c].id+'">'+b.objects[c].name+'</div>')},_previewSelectTermsLoaded:function(f){var b=JSON.parse(f),d=a('[data-location="taxonomy:'+b.taxonomy+'"]'),e=d.find('.fl-theme-builder-preview-select-item-children'),c=0;for(d.attr('data-children-loaded','1'),e.find('img').remove();c<b.objects.length;c++)e.append('<div class="fl-theme-builder-preview-select-item-child" data-location="taxonomy:'+b.taxonomy+':'+b.objects[c].id+'">'+b.objects[c].name+'</div>')},_previewSelectItemChildClicked:function(b){var c=a(b.target).closest('.fl-theme-builder-preview-select-item-child');title=a('.fl-theme-builder-preview-select-title div span'),title.text(c.text()),a('.fl-theme-builder-preview-select').removeClass('fl-theme-builder-preview-select-open'),a('.fl-theme-builder-preview-select-item-open').removeClass('fl-theme-builder-preview-select-item-open'),FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:'update_preview_location',location:c.attr('data-location')},function(){FLBuilder.showAjaxLoader(),window.location.reload(!0)}),b.stopPropagation()},_initContent:function(){var b=a('.fl-builder-content-primary[data-type="part"]'),c=a('.fl-builder-content-primary:not([data-type="part"])');b.length&&(c.after('<div class="fl-theme-builder-content-placeholder" style="padding: 200px 100px; text-align:center; opacity:0.5;">Content Area</div>'),b.after(c),b.remove())}},a(function(){FLThemeBuilderLayoutFrontendEdit._init()})})(jQuery)